<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DateTime | Developer Handbook</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/favicon.png">
    <meta name="description" content="Documentation for developers">
    
    <link rel="preload" href="/assets/css/0.styles.570e68b7.css" as="style"><link rel="preload" href="/assets/js/app.d83601b0.js" as="script"><link rel="preload" href="/assets/js/2.7388b1db.js" as="script"><link rel="preload" href="/assets/js/37.48eb6cc4.js" as="script"><link rel="prefetch" href="/assets/js/10.c7143eb3.js"><link rel="prefetch" href="/assets/js/11.0a4511c2.js"><link rel="prefetch" href="/assets/js/12.dfcbdb3f.js"><link rel="prefetch" href="/assets/js/13.6c066316.js"><link rel="prefetch" href="/assets/js/14.323f04a2.js"><link rel="prefetch" href="/assets/js/15.f5781461.js"><link rel="prefetch" href="/assets/js/16.dbc9a88e.js"><link rel="prefetch" href="/assets/js/17.8229e3e6.js"><link rel="prefetch" href="/assets/js/18.7680b9c4.js"><link rel="prefetch" href="/assets/js/19.943ea467.js"><link rel="prefetch" href="/assets/js/20.66bf8e16.js"><link rel="prefetch" href="/assets/js/21.54484492.js"><link rel="prefetch" href="/assets/js/22.aeb0346e.js"><link rel="prefetch" href="/assets/js/23.3ab4cf6a.js"><link rel="prefetch" href="/assets/js/24.9809239a.js"><link rel="prefetch" href="/assets/js/25.46acd5ae.js"><link rel="prefetch" href="/assets/js/26.a0a216a4.js"><link rel="prefetch" href="/assets/js/27.125c4157.js"><link rel="prefetch" href="/assets/js/28.a071af3f.js"><link rel="prefetch" href="/assets/js/29.a0dedc08.js"><link rel="prefetch" href="/assets/js/3.9cdaed40.js"><link rel="prefetch" href="/assets/js/30.ed1aeb9e.js"><link rel="prefetch" href="/assets/js/31.a95e31e1.js"><link rel="prefetch" href="/assets/js/32.f0d74b78.js"><link rel="prefetch" href="/assets/js/33.8b508a87.js"><link rel="prefetch" href="/assets/js/34.7abf93fa.js"><link rel="prefetch" href="/assets/js/35.9b59ba6b.js"><link rel="prefetch" href="/assets/js/36.45379831.js"><link rel="prefetch" href="/assets/js/38.5b0464de.js"><link rel="prefetch" href="/assets/js/39.76b2b34b.js"><link rel="prefetch" href="/assets/js/4.2b20bffe.js"><link rel="prefetch" href="/assets/js/40.02ab208f.js"><link rel="prefetch" href="/assets/js/41.dba5aec9.js"><link rel="prefetch" href="/assets/js/42.380c5397.js"><link rel="prefetch" href="/assets/js/43.3031ae98.js"><link rel="prefetch" href="/assets/js/5.7786025c.js"><link rel="prefetch" href="/assets/js/6.f4386ed2.js"><link rel="prefetch" href="/assets/js/7.771c23fc.js"><link rel="prefetch" href="/assets/js/8.b74ecbcd.js"><link rel="prefetch" href="/assets/js/9.c1c2c4ff.js">
    <link rel="stylesheet" href="/assets/css/0.styles.570e68b7.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Developer Handbook</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/stakater/developer-handbook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/stakater/developer-handbook" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Architecture</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Java Backend</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/content/java-backend/" aria-current="page" class="sidebar-link">Java Backend</a></li><li><a href="/content/java-backend/datetime.html" aria-current="page" class="active sidebar-link">DateTime</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/content/java-backend/datetime.html#what-is-iso-8601" class="sidebar-link">What is ISO-8601?</a></li><li class="sidebar-sub-header"><a href="/content/java-backend/datetime.html#how-to-get-current-in-utc-in-iso-8601-on-backend-in-java" class="sidebar-link">How to get current in UTC in ISO-8601 on backend in Java?</a></li><li class="sidebar-sub-header"><a href="/content/java-backend/datetime.html#how-to-do-conversion-on-frontend" class="sidebar-link">How to do conversion on frontend?</a></li><li class="sidebar-sub-header"><a href="/content/java-backend/datetime.html#references" class="sidebar-link">References</a></li></ul></li><li><a href="/content/java-backend/logging.html" class="sidebar-link">Logging</a></li><li><a href="/content/java-backend/dto.html" class="sidebar-link">ValueObject or DTO</a></li><li><a href="/content/java-backend/force-not-null.html" class="sidebar-link">Force not null</a></li><li><a href="/content/java-backend/wf-engine.html" class="sidebar-link">Workflow Engine</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Frontend</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Database</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>API</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Testing</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Git</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>IAM</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kubernetes</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="datetime">DateTime</h1> <p>Let’s say you’re building your first API. Be it public, private, or some hybrid thereof, don’t be surprised if your first defect is date/time-related. Do not underestimate how much trouble you can get into when it comes to handling date and times. Here are some tips which might keep you out of this potential future.</p> <ul><li>Always use <code>java.util.Date</code>! Domain shouldn’t need to care about timezone! <code>java.util.date</code> is the safest and best way to store stuff in data stores.</li> <li>TimeZone is a presentation concern; and presentation should bother about it and take care of it. Backend should be free of timezone and should only contain datetime in UTC format.</li> <li>Always use <code>UTC</code> timezone</li> <li>Always use <code>ISO-8601</code> for your dates and set this property: <code>spring.jackson.serialization.WRITE_DATES_AS_TIMESTAMPS = false</code></li> <li>Accept any timezone</li> <li>Store it in <code>UTC</code> in <code>ISO-8601</code></li> <li>Return it in <code>UTC</code> in <code>ISO-8601</code></li> <li>Don’t use time if you don’t need it!</li></ul> <p>You should return an absolute point in time, then anyone can localize that timestamp as needed. By &quot;absolute timestamp&quot; I mean either a UNIX timestamp or a human readable timestamp which includes the timezone in one of the standardized ISO formats, e.g. IS0-8601 &quot;2007-04-05T14:30:35Z&quot;. This can trivially be converted to a local timezone by the client as necessary.</p> <p>Dealing with timezones is notoriously difficult and the technical options are wide open.</p> <h2 id="what-is-iso-8601">What is ISO-8601?</h2> <p>Generally, ISO-8601 looks something like <code>2009-05-20</code> for dates and <code>2009-05-20T12:30:30Z</code> for date/time combinations.</p> <h2 id="how-to-get-current-in-utc-in-iso-8601-on-backend-in-java">How to get current in UTC in ISO-8601 on backend in Java?</h2> <p>Convert Date String to/from ISO 8601 respecting UTC in Java.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>public static String toISO8601UTC(Date date) {
  TimeZone tz = TimeZone.getTimeZone(&quot;UTC&quot;);
  DateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm'Z'&quot;);
  df.setTimeZone(tz);
  return df.format(date);
}

public static Date fromISO8601UTC(String dateStr) {
  TimeZone tz = TimeZone.getTimeZone(&quot;UTC&quot;);
  DateFormat df = new SimpleDateFormat(&quot;yyyy-MM-dd'T'HH:mm'Z'&quot;);
  df.setTimeZone(tz);
  
  try {
    return df.parse(dateStr);
  } catch (ParseException e) {
    // TODO: throw exception
  }
  
  // TODO: throw exception
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="how-to-do-conversion-on-frontend">How to do conversion on frontend?</h2> <p>We’ll do the conversion in JS – but it’s worth understanding that, for read operations, the server still returns UTC dates.</p> <p><a href="http://momentjs.com/" target="_blank" rel="noopener noreferrer">Moment.js<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> helps here with the timezone conversion.</p> <p>This code should work (haven't tested it on browser)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>function convertDate(date){
    // this will return UTC
    var serverTimezone = [[${#dates.format(#calendars.createToday(), 'z')}]];
    // datetime recieved over API in UTC
    var serverDate = moment.tz(date, serverTimezone);
    // user browser to get client time zone (plz read the section below)
    var clientTimezone = moment.tz.guess();
    var clientDate = serverDate.clone().tz(clientTimezone);
    // example sample format
    var myformat = &quot;YYYY-MM-DD HH:mm&quot;;
    return clientDate.format(myformat);
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="how-to-find-the-timezone-of-the-client">How to find the timezone of the client?</h3> <p>The question is if server is always returning UTC then how do I convert in the browser into client timezone? How do I find the timezone?</p> <p>You can use:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>moment-timezone
&lt;script src=&quot;moment.js&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;moment-timezone-with-data.js&quot;&gt;&lt;/script&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>// retrieve timezone by name (i.e. &quot;America/Chicago&quot;)
moment.tz.guess();
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>Browser time zone detection is rather tricky to get right, as there is little information provided by the browser.</p> <p>Moment Timezone uses Date.getTimezoneOffset() and Date.toString() on a handful of moments around the current year to gather as much information about the browser environment as possible. It then compares that information with all the time zone data loaded and returns the closest match. In case of ties, the time zone with the city with largest population is returned.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>console.log(moment.tz.guess()); // America/Chicago
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>This is the only one that gives the actual timezone name rather than offset. Remember that timezone offset can be derived from the name, the opposite isn't true. Because of DST and other subtleties, multiple timezones can have the same offset on some specific days of the year only.</p> <h2 id="references">References</h2> <ul><li><a href="http://apiux.com/2013/03/20/5-laws-api-dates-and-times/" target="_blank" rel="noopener noreferrer">The 5 laws of API dates and times<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.baeldung.com/reddit-app-show-date-in-the-users-timezone" target="_blank" rel="noopener noreferrer">Show date in users timezone<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/stakater/developer-handbook/edit/master/content/java-backend/datetime.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/content/java-backend/" class="prev router-link-active">
        Java Backend
      </a></span> <span class="next"><a href="/content/java-backend/logging.html">
        Logging
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d83601b0.js" defer></script><script src="/assets/js/2.7388b1db.js" defer></script><script src="/assets/js/37.48eb6cc4.js" defer></script>
  </body>
</html>
